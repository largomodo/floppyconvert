# Floppy Conversion Tool - Code Index

| File | What | When |
|------|------|------|
| `pom.xml` | Maven build configuration: Java 21, groupId `com.largomodo`, JUnit 5.10.5, jqwik 1.8.2, Mockito 5.21.0, Commons Exec 1.6.0, Picocli 4.7.7, SLF4J 2.0.17, Logback 1.5.24, two-section resource filtering (filtered floppyconvert.properties, non-filtered binary .img templates), `native` profile with GraalVM native-maven-plugin 0.10.1 (`--no-fallback`, `-march=compatibility`, metadata repository enabled), `picocli-codegen` annotation processor for GraalVM reflect-config generation | Modifying dependencies, build settings, JAR manifest, resource filtering behavior, or GraalVM native-image build configuration |
| `src/main/resources/floppyconvert/floppyconvert.properties` | Maven-filtered properties: application.name, application.version, application.url for Picocli resourceBundle | Changing CLI metadata displayed in --help, debugging missing property injection |
| `src/main/java/com/largomodo/floppyconvert/FloppyConvert.java` | CLI entry point: Picocli-based argument parsing with @Command/@Parameters/@Option annotations, resourceBundle for dynamic metadata injection (${bundle:application.name}), SLF4J Logger, MDC context management, --verbose flag for DEBUG level, automatic help generation, smart defaults for output directory (. for files, input/output for directories), single positional input parameter replaces --input-file/--input-dir, SnesRomMatcher::isRom batch filter (replaces .sfc hardcoded filter), single-file validation rejects non-ROM formats, no --empty-image option (template bundled as JAR resource), no --mtools-path option (native FAT12 engine), implements Callable<Integer>, instantiates DefaultConversionFacade, runBatch() decomposed to 44 lines with 6 extracted helper methods (collectRomFiles, createExecutorService, createFinalObserver, submitConversionTasks, initiateShutdown, awaitTermination) | Adding CLI arguments, changing argument defaults, debugging argument validation, understanding Picocli pattern, modifying log verbosity behavior, debugging multi-format support, understanding batch processing helpers |
| `src/main/resources/logback.xml` | Logback configuration: three appenders (STDOUT, FILE, FAILURES), MDC pattern %X{rom} for thread context, INFO default level, ThresholdFilter on STDOUT, LevelFilter on FAILURES | Modifying log output format, changing log levels, debugging logging issues |
| `src/main/resources/META-INF/native-image/com.largomodo/floppyconvert/reflect-config.json` | GraalVM native-image reflection configuration: Logback filter classes (ThresholdFilter, LevelFilter), UnsynchronizedAppenderBase.addFilter() method registration, Level and FilterReply class registration for Logback XML property resolution | Debugging GraalVM native-image runtime errors, adding reflection metadata for new libraries or Logback configuration changes |
| `src/main/java/com/largomodo/floppyconvert/format/CopierFormat.java` | Enum for backup unit formats (FIG/SWC/UFO/GD3) with ucon64 command flags | Adding new format support or changing format-specific behavior |
| `src/main/java/com/largomodo/floppyconvert/format/README.md` | Architecture rationale: format package extraction from core to break circular dependencies (core→service→core), acyclic package structure (FloppyConvert→core→service→snes→format), invariants (no dependencies in format package) | Understanding package restructuring decisions, reviewing circular dependency resolution |
| `src/main/java/com/largomodo/floppyconvert/core/FloppyType.java` | Enum for floppy disk formats (720KB/1.44MB/1.6MB) with capacity limits and bestFit() selection logic | Adding new disk format or debugging capacity errors |
| `src/main/java/com/largomodo/floppyconvert/core/ConversionFacade.java` | Interface for ROM conversion operations: splitRom() and write() methods, abstracts RomSplitter and FloppyImageWriter dependencies | Adding alternative conversion implementations, understanding facade pattern |
| `src/main/java/com/largomodo/floppyconvert/core/DiskTemplateFactory.java` | Interface for floppy disk template providers, method signature uses targetImage parameter | Adding alternative template sources or understanding template abstraction |
| `src/main/java/com/largomodo/floppyconvert/core/ResourceDiskTemplateFactory.java` | Loads floppy disk templates from JAR classpath resources, method signature uses targetImage parameter | Debugging template loading failures or modifying resource paths |
| `src/main/java/com/largomodo/floppyconvert/core/RomPartComparator.java` | Universal comparator for ROM part sorting (numeric extensions, UFO .gm extensions with numeric prefix extraction, alphanumeric filenames) | Debugging sort order issues or extending to new naming patterns |
| `src/main/java/com/largomodo/floppyconvert/core/RomPartNormalizer.java` | Stateless utility for ROM part filename sanitization and metadata generation | Debugging filename sanitization issues, shell compatibility problems, or understanding metadata creation |
| `src/main/java/com/largomodo/floppyconvert/core/RomProcessor.java` | ROM processing pipeline orchestrator with DI, SLF4J logger for status output, uses ConversionFacade abstraction, processRom() decomposed to 41 lines with 7 extracted helper methods (ensureWorkspaceExists, processSplitRom, createMetadata, createDiskLayout, processDiskLayouts, createDiskImage, addPartsToDiskImage), coordinates DiskPacker/ConversionFacade/DiskTemplateFactory/RomPartNormalizer via ConversionWorkspace, includes output directory structure handling and interrupt-safe cleanup | Changing disk spanning logic, debugging DOS name collisions, modifying pipeline flow, understanding orchestration pattern, troubleshooting dependency injection, understanding processRom() decomposition |
| `src/main/java/com/largomodo/floppyconvert/core/domain/RomPartMetadata.java` | Domain record for ROM part metadata (path, size, DOS name) with null validation | Understanding DiskPacker input format, debugging validation errors |
| `src/main/java/com/largomodo/floppyconvert/core/domain/DiskLayout.java` | Domain record for disk contents and floppy type | Understanding DiskPacker output format |
| `src/main/java/com/largomodo/floppyconvert/core/domain/DiskPacker.java` | Bin-packing algorithm interface | Adding alternative packing strategies |
| `src/main/java/com/largomodo/floppyconvert/core/domain/GreedyDiskPacker.java` | First-fit decreasing bin-packing implementation | Debugging disk capacity issues or modifying packing algorithm |
| `src/main/java/com/largomodo/floppyconvert/core/workspace/ConversionWorkspace.java` | AutoCloseable workspace for artifact tracking and cleanup with interrupt flag handling, SLF4J logger for warnings, throws CleanupException with suppressed exceptions on cleanup failures; thread-safe when each instance confined to single thread (no shared workspace directories) | Understanding resource management pattern, debugging cleanup issues, troubleshooting interrupt behavior, understanding promoteToFinal atomic move pattern, handling CleanupException |
| `src/main/java/com/largomodo/floppyconvert/core/workspace/CleanupException.java` | Exception for workspace cleanup failures with support for suppressed exceptions | Understanding cleanup error handling, debugging workspace cleanup issues |
| `src/main/java/com/largomodo/floppyconvert/core/ConversionObserver.java` | Observer interface for batch processing events | Adding progress monitoring or telemetry |
| `src/main/java/com/largomodo/floppyconvert/core/README.md` | Architecture rationale: ConversionFacade dependency inversion pattern (core depends on abstraction, service provides implementation), god method decomposition (RomProcessor.processRom() and FloppyConvert.runBatch() <50 line threshold with extracted helpers), per-layout DOS name validation, invariants (no concrete service imports in core, method complexity limits) | Understanding facade pattern decisions, reviewing god method decomposition, troubleshooting architectural boundaries |
| `src/main/java/com/largomodo/floppyconvert/service/RomSplitter.java` | Interface for ROM splitting adapters | Adding alternative ROM splitting tools |
| `src/main/java/com/largomodo/floppyconvert/service/DefaultConversionFacade.java` | Default implementation of ConversionFacade: delegates to RomSplitter and FloppyImageWriter, constructor DI for splitter and writer dependencies | Understanding facade implementation, debugging delegation logic |
| `src/main/java/com/largomodo/floppyconvert/service/NativeRomSplitter.java` | Native Java ROM splitter: orchestrates SnesRomReader, SnesInterleaver, HeaderGeneratorFactory, UfoHiRomChunker for split file generation, 4Mbit chunks (SWC/FIG/UFO LoROM) or 8Mbit chunks (GD3), GD3 force-split (HiROM ≤16Mbit uses 4Mbit chunks triggering X-padding), UFO HiROM irregular chunks via lookup table, conditional GD3 HiROM global interleaving, FileChannel I/O, format-specific naming (FIG/SWC: .1/.2, UFO: .1gm/.2gm, GD3: SF-Code with .078 extension), stateless service implementing RomSplitter interface | Debugging split boundaries, changing chunk sizes, understanding GD3 force-split condition, understanding UFO chunker detection, troubleshooting file I/O, understanding GD3 SF-Code naming conventions |
| `src/main/java/com/largomodo/floppyconvert/service/UfoHiRomChunker.java` | UFO HiROM irregular chunk calculator: computeChunks(totalSizeMbit) static method (plan references calculate() - renamed for consistency with compute prefix naming convention), lookup table for 5 ROM sizes (2, 4, 12, 20, 32 Mbit), returns List<UfoChunk> with (sizeMbit, flag) pairs, flag encoding (0x40 multi-start, 0x10 multi-continue, 0x00 last-part) from ucon64 size_to_flags table, throws IllegalArgumentException for unsupported sizes, UfoChunk record with validation | Understanding UFO copier bank allocation, debugging irregular chunk sequences, adding new ROM size support, troubleshooting flag encoding |
| `src/main/java/com/largomodo/floppyconvert/service/FloppyImageWriter.java` | Interface for floppy image injection adapters | Adding alternative floppy image tools |
| `src/main/java/com/largomodo/floppyconvert/service/fat/Fat12ImageWriter.java` | Native Java FAT12 image writer: memory-mapped I/O, little-endian ByteBuffer, BPB parsing, cluster chaining, FAT mirroring | Debugging FAT12 write operations, understanding native implementation |
| `src/main/java/com/largomodo/floppyconvert/service/README.md` | Split pipeline architecture: data flow diagrams, format-specific naming conventions (FIG/SWC .1/.2, UFO .1gm/.2gm, GD3 SF-Code), GD3 X-padding edge cases, dual-source size encoding rationale (UFO), design tradeoffs (inline naming vs extraction, per-part size parameter) | Understanding ROM splitting architecture, debugging GD3 SF-Code naming, understanding format-specific naming decisions, troubleshooting split pipeline issues |
| `src/main/java/com/largomodo/floppyconvert/snes/SnesConstants.java` | Shared constants for SNES ROM operations: MBIT = 131072 (1 Mbit = 128 KB per SNES specification), centralizes magic numbers to prevent duplication across validators and utilities | Adding new SNES-related constants, understanding size calculations |
| `src/main/java/com/largomodo/floppyconvert/snes/SnesRom.java` | Immutable domain record for SNES ROM metadata: RomType (LoROM/HiROM/ExHiROM), SRAM size, DSP flag, title, checksum fields, rawData byte array, isHiRom() helper method, null validation in compact record form | Understanding ROM metadata structure, debugging header parsing, validating ROM integrity |
| `src/main/java/com/largomodo/floppyconvert/snes/RomType.java` | Enum for SNES memory map types: LoROM (0x7FB0 header), HiROM (0xFFB0 header), ExHiROM (0x40FFB0 header) | Adding new ROM types, understanding header location mapping |
| `src/main/java/com/largomodo/floppyconvert/snes/SnesRomReader.java` | SNES ROM parser: strips 512-byte copier headers, probes internal header locations (0x7FB0/0xFFB0/0x40FFB0), weighted scoring algorithm for type detection, extracts metadata (title, SRAM, DSP, checksum), validates checksum+complement=0xFFFF, returns SnesRom record, Map Mode 0x25 detection for ExHiROM classification | Debugging ROM detection failures, understanding scoring weights, adding new header locations, troubleshooting checksum validation, understanding ExHiROM detection |
| `src/main/java/com/largomodo/floppyconvert/snes/HardwareValidator.java` | Interface for format-specific ROM validation: validate(SnesRom, CopierFormat) throws UnsupportedHardwareException, enables format-specific validation strategies following HeaderGenerator pattern | Adding alternative validation implementations, understanding validation abstraction |
| `src/main/java/com/largomodo/floppyconvert/snes/UnsupportedHardwareException.java` | RuntimeException for hardware constraint violations: thrown when ROM conversion exceeds copier format hardware constraints, follows CleanupException pattern for unchecked exceptional conditions | Understanding validation error handling, debugging hardware compatibility issues |
| `src/main/java/com/largomodo/floppyconvert/snes/UfoHardwareValidator.java` | UFO format hardware validation: enforces 32Mbit HiROM ceiling (ucon64 snes.c:1445), 36Mbit LoROM ceiling (max 9 parts at 4Mbit chunks), implements HardwareValidator interface | Debugging UFO hardware compatibility issues, understanding UFO constraints |
| `src/main/java/com/largomodo/floppyconvert/snes/Gd3HardwareValidator.java` | GD3 format hardware validation: enforces 32Mbit standard HiROM/LoROM ceiling, allows ExHiROM up to 64Mbit (extended memory maps), implements HardwareValidator interface | Debugging GD3 hardware compatibility issues, understanding ExHiROM support |
| `src/main/java/com/largomodo/floppyconvert/snes/SpecialCaseRegistry.java` | Static utility for game-specific detection: isTalesOfPhantasia(SnesRom) checks maker 0x36 + title, isDaiKaijuMonogatari2(SnesRom) checks maker 0x18 + title, games requiring non-standard GD3 header values per ucon64 snes.c:955-1010 | Understanding game-specific quirks, debugging header override behavior, adding new special cases |
| `src/main/java/com/largomodo/floppyconvert/snes/SnesInterleaver.java` | GD3 HiROM/ExHiROM interleaver: pads to 8Mbit boundaries with 0x00, global block swapping across entire ROM (not per-chunk), offset n = size/2 partitions output buffer, upper 32KB of each 64KB block → output first half, lower 32KB → output second half, ExHiROM split-interleaving (base 32Mbit + expansion separately), LoROM bypass (no interleaving), stateless service, returns new byte array (non-destructive) | Debugging GD3 interleaving, understanding global vs per-chunk algorithm, troubleshooting padding behavior, understanding symmetric block distribution, understanding ExHiROM split-interleaving |
| `src/main/java/com/largomodo/floppyconvert/snes/README.md` | Architecture overview: staged pipeline (read, interleave, split, write), data flow diagrams, design rationale (immutable records, separation of concerns, factory pattern), invariants (checksum validation, 8Mbit alignment, header consistency, interleaving is destructive) | Understanding SNES conversion architecture, reviewing design decisions, troubleshooting pipeline issues |
| `src/main/java/com/largomodo/floppyconvert/snes/header/HeaderGenerator.java` | Interface for copier format header generation: generateHeader(SnesRom, partSize, splitPartIndex, isLastPart, chunkFlag) returns byte[512] or empty byte[], partSize parameter provides per-part ROM data size for block calculations (SWC/FIG/UFO use partSize, GD3 ignores it, UFO uses partSize for bytes 0-1 but total ROM size for byte 17), chunkFlag parameter enables UFO irregular chunk flag encoding (0x40/0x10/0x00), non-UFO formats ignore chunkFlag | Adding new copier formats, understanding header generation contract, understanding partSize parameter usage, understanding chunkFlag parameter for UFO HiROM |
| `src/main/java/com/largomodo/floppyconvert/snes/header/HeaderGeneratorFactory.java` | Factory for format-specific header generators: instantiates format-specific SramEncoders, returns SwcHeaderGenerator, FigHeaderGenerator, UfoHeaderGenerator, or Gd3HeaderGenerator based on CopierFormat | Adding new format support, debugging generator selection |
| `src/main/java/com/largomodo/floppyconvert/snes/header/SramEncoder.java` | Strategy interface for format-specific SRAM encoding: encodeSram(byte[], SnesRom) mutates header array at format-specific byte offsets | Understanding SRAM encoding abstraction, adding new encoding strategies |
| `src/main/java/com/largomodo/floppyconvert/snes/header/SwcSramEncoder.java` | SWC SRAM encoding strategy: byte 2 encoding (0x0C/0x08/0x04/0x00 for 256KB/64KB/16KB/0KB) | Debugging SWC SRAM encoding, understanding byte 2 mapping |
| `src/main/java/com/largomodo/floppyconvert/snes/header/FigSramEncoder.java` | FIG SRAM encoding strategy: byte 3 encoding (0x0C/0x08/0x04/0x00 for 256KB/64KB/16KB/0KB) | Debugging FIG SRAM encoding, understanding byte 3 mapping |
| `src/main/java/com/largomodo/floppyconvert/snes/header/UfoSramEncoder.java` | UFO SRAM encoding strategy: byte 4 size codes (0/1/2/3/8 for 0KB/16KB/64KB/256KB/512KB), bytes 5-6 mapping controls (A15, A20-A23) | Debugging UFO SRAM encoding, understanding SRAM mapping controls |
| `src/main/java/com/largomodo/floppyconvert/snes/header/Gd3SramEncoder.java` | GD3 SRAM encoding strategy: byte 7 encoding for HiROM (0x29 with SRAM, 0x2A without), byte 2 encoding for LoROM (0x14 DSP+SRAM, 0x1C DSP-only, 0x24 SRAM-only, 0x28 neither) | Debugging GD3 SRAM encoding, understanding HiROM vs LoROM encoding differences |
| `src/main/java/com/largomodo/floppyconvert/snes/header/SwcHeaderGenerator.java` | SWC copier header generator: emulation mode (0x30 HiROM/0x00 LoROM), delegates SRAM encoding to injected SwcSramEncoder, multi-file flag (0x40), fixed IDs (0xAA/0xBB/0x04), size in 8KB blocks calculated from partSize parameter, chunkFlag parameter ignored (uses isLastPart for multi-file flag) | Debugging SWC headers, troubleshooting emulation flags, understanding partSize usage, understanding SramEncoder delegation |
| `src/main/java/com/largomodo/floppyconvert/snes/header/FigHeaderGenerator.java` | FIG copier header generator: HiROM flag (0x80), multi-file flag (0x40), delegates SRAM encoding to injected FigSramEncoder, emulation bytes with DSP logic, headers on all parts (not just first), size in 8KB blocks calculated from partSize parameter, chunkFlag parameter ignored (uses isLastPart for multi-file flag) | Debugging FIG headers, understanding DSP flag encoding, troubleshooting multi-part behavior, understanding partSize usage, understanding SramEncoder delegation |
| `src/main/java/com/largomodo/floppyconvert/snes/header/UfoHeaderGenerator.java` | UFO copier header generator: "SUPERUFO" ID string, bank type (0 HiROM/1 LoROM), delegates SRAM encoding to injected UfoSramEncoder, dual-source size encoding (partSize for bytes 0-1, total ROM size for byte 17), chunkFlag parameter used for byte 2 (multi-file flag from lookup table) | Debugging UFO headers, troubleshooting bank type selection, understanding dual-source size requirement, understanding chunkFlag encoding, understanding SramEncoder delegation |
| `src/main/java/com/largomodo/floppyconvert/snes/header/Gd3HeaderGenerator.java` | GD3 copier header generator: "GAME DOCTOR SF 3" ID, first-part-only headers (empty byte[] for parts > 0), delegates SRAM encoding to injected Gd3SramEncoder, memory map table selection based on total ROM size (partSize parameter ignored), memory map tables (8MB/16MB/24MB/32MB HiROM, 4MB/8MB/16MB/32MB LoROM), chunkFlag parameter ignored (first-part-only headers) | Debugging GD3 headers, understanding memory map tables, understanding why partSize is ignored, understanding SramEncoder delegation |
| `src/main/java/com/largomodo/floppyconvert/snes/header/README.md` | Header format specifications: format-specific quirks (FIG headers on all parts, GD3 first-part-only, 8Mbit alignment), SRAM encoder strategy pattern (4 format-specific implementations), SRAM encoding tables, memory map selection logic, DSP flag handling, partSize parameter usage documentation, idempotence warning for SRAM encoders | Understanding copier format differences, debugging header generation issues, adding new format support, understanding per-part vs total ROM size usage, understanding SRAM encoding abstraction |
| `src/main/java/com/largomodo/floppyconvert/util/DosNameUtil.java` | DOS 8.3 filename sanitization logic | Changing filename truncation, special character handling, or extension preservation |
| `src/main/java/com/largomodo/floppyconvert/util/SnesRomMatcher.java` | SNES ROM format detection: static utility with isRom(Path) method, supports extensions (.sfc, .fig, .swc, .ufo, .1) and Game Doctor naming via regex, Files.isRegularFile check to prevent directory false positives | Adding new ROM format support, debugging format detection, understanding batch filter logic |
| `src/test/java/com/largomodo/floppyconvert/FloppyConvertTest.java` | Test cases for CLI argument parsing: positional parameters, smart output defaults, enum parsing, validation | Verifying Picocli argument handling, testing CLI behavior |
| `src/test/java/com/largomodo/floppyconvert/CopierFormatTest.java` | Parameterized tests for CopierFormat enum: format conversion from file extensions, case-insensitivity, invalid format handling | Verifying CopierFormat behavior, adding new format test cases |
| `src/test/java/com/largomodo/floppyconvert/README.md` | Test utilities architecture: ROM provisioning pattern (TestRomProvider + E2ETestRomRegistry), component interaction diagram, design rationale (registry + provider over alternatives), invariants | Understanding test ROM provisioning decisions, reviewing design tradeoffs |
| `src/test/java/com/largomodo/floppyconvert/E2ETestRomRegistry.java` | ROM registry constants: 8 real ROM resource paths (CHRONO_TRIGGER, SUPER_MARIO_WORLD, etc.), RomSpec record (sizeMbit, type, sramSizeKb, hasDsp, title), static Map<String, RomSpec> mapping real paths to synthetic specs, getSpec(resourcePath) lookup method | Adding new ROM mappings, debugging registry lookup failures, understanding synthetic fallback specifications |
| `src/test/java/com/largomodo/floppyconvert/TestRomProvider.java` | ROM provisioning utility: getRomOrSynthetic(resourcePath, outputDir) tries real ROM from classpath then falls back to synthetic, getRealRom() returns Optional<Path>, createSyntheticRom(RomSpec, outputDir) delegates to SyntheticRomFactory, switch expression for RomType routing | Debugging E2E ROM acquisition, understanding fallback logic, modifying ROM provisioning behavior |
| `src/test/java/com/largomodo/floppyconvert/TestRomProviderTest.java` | Unit tests for TestRomProvider: real ROM exists returns real path, real ROM missing returns synthetic path, synthetic ROM has correct title from registry, determinism verification, unknown ROM path error handling | Verifying ROM provider fallback logic, adding new provider test cases |
| `src/test/java/com/largomodo/floppyconvert/FloppyConvertLoggingTest.java` | Test cases for logging with synthetic ROMs: verbose flag, MDC context propagation (LOGTEST4L.sfc), failures appender, no ROM availability assumptions | Verifying logging behavior |
| `src/test/java/com/largomodo/floppyconvert/FloppyConvertConcurrencyTest.java` | Integration tests for concurrent batch processing with synthetic ROMs: workspace isolation, observer thread-safety, graceful shutdown, uses CONCUR4L synthetic ROM, no ROM availability assumptions | Debugging concurrency issues or validating thread pool behavior |
| `src/test/java/com/largomodo/floppyconvert/FloppyConvertE2ETest.java` | E2E tests for full conversion pipeline across all formats (FIG/SWC/UFO/GD3) with TestRomProvider fallback: GD3 force-split tests (8Mbit/16Mbit/20Mbit HiROM), UFO irregular chunk tests (12Mbit HiROM with flag validation, 12Mbit LoROM standard chunks), ExHiROM 48Mbit test, uses real ROMs when available or synthetic fallback, no assumptions/aborts | Debugging conversion failures, adding new format support, validating pipeline changes, verifying GD3 force-split behavior, verifying UFO irregular chunks, understanding E2E fallback pattern |
| `src/test/java/com/largomodo/floppyconvert/FloppyConvertRecursionTest.java` | Integration tests for recursive directory traversal with synthetic ROMs: deep nesting, sibling directories, root-level files, symlink behavior, uses RECURS4L synthetic ROM in @BeforeAll, no ROM availability assumptions | Debugging structure preservation, verifying recursive traversal behavior, validating path mirroring |
| `src/test/java/com/largomodo/floppyconvert/service/DefaultConversionFacadeTest.java` | Unit tests for DefaultConversionFacade: delegation to RomSplitter and FloppyImageWriter, parameter passing | Verifying facade delegation, testing constructor DI |
| `src/test/java/com/largomodo/floppyconvert/service/NativeRomSplitterTest.java` | Integration tests for NativeRomSplitter with mocked dependencies: split boundary calculations, file naming for all formats (FIG/SWC .1/.2, UFO .1gm/.2gm, GD3 .078), conditional interleaving (GD3+HiROM only), header generation delegation, GD3 force-split tests (8Mbit/16Mbit boundary), UFO irregular chunk tests (12Mbit HiROM vs LoROM) | Verifying split logic, format-specific naming, interleaving behavior, GD3 force-split condition, UFO chunker integration |
| `src/test/java/com/largomodo/floppyconvert/service/UfoHiRomChunkerTest.java` | Property-based tests for UFO HiROM chunk calculator: all supported sizes (2, 4, 12, 20, 32 Mbit) produce correct chunk sequences, chunk sum equals total size, flag sequence correctness (first 0x40/0x10, last always 0x00), 32Mbit fallback for unsupported sizes | Verifying UFO chunk sequences, validating lookup table correctness, testing fallback behavior |
| `src/test/java/com/largomodo/floppyconvert/service/fat/Fat12ImageWriterTest.java` | Unit tests for native FAT12 writer: cluster allocation, FAT mirroring, directory entries, disk full scenarios | Verifying FAT12 operations, adding test cases for edge cases |
| `src/test/java/com/largomodo/floppyconvert/core/FloppyTypeTest.java` | Property-based tests for FloppyType: bestFit() boundary selection for 720KB, 1.44MB, 1.6MB disk capacities | Verifying disk capacity selection logic, debugging bestFit edge cases |
| `src/test/java/com/largomodo/floppyconvert/core/ResourceDiskTemplateFactoryTest.java` | Unit tests for ResourceDiskTemplateFactory: classpath resource loading for disk templates | Verifying template loading behavior, debugging resource path issues |
| `src/test/java/com/largomodo/floppyconvert/core/RomPartNormalizerTest.java` | Unit tests for RomPartNormalizer: filename sanitization, metadata generation | Verifying filename sanitization, debugging DOS name generation |
| `src/test/java/com/largomodo/floppyconvert/core/RomPartComparatorTest.java` | Test cases for universal ROM part sorting (numeric extensions, UFO .gm extensions, alphanumeric filenames) | Verifying sort behavior for new format or edge cases |
| `src/test/java/com/largomodo/floppyconvert/core/domain/RomPartMetadataTest.java` | Unit tests for RomPartMetadata record: validation, immutability | Verifying domain record behavior |
| `src/test/java/com/largomodo/floppyconvert/core/domain/DiskLayoutTest.java` | Unit tests for DiskLayout record: immutability, list wrapping | Verifying domain record behavior |
| `src/test/java/com/largomodo/floppyconvert/core/domain/GreedyDiskPackerTest.java` | Unit tests for bin-packing algorithm: empty input, single disk, multi-disk spanning, oversized parts | Debugging packing behavior or adding test cases |
| `src/test/java/com/largomodo/floppyconvert/core/workspace/ConversionWorkspaceTest.java` | Unit tests for workspace cleanup: tracked files, final outputs, nested directories, Windows locking | Debugging cleanup issues or validating AutoCloseable contract |
| `src/test/java/com/largomodo/floppyconvert/core/RomProcessorTest.java` | Unit tests for RomProcessor with mocked dependencies: delegation, exception handling, workspace cleanup | Debugging orchestration logic without external tools |
| `src/test/java/com/largomodo/floppyconvert/snes/HardwareValidatorTest.java` | Property-based tests for hardware validators: UFO HiROM 32Mbit boundary, UFO LoROM 36Mbit boundary, GD3 ExHiROM 64Mbit boundary, GD3 standard 32Mbit boundary, synthetic ROM generation at size boundaries | Verifying hardware validation behavior, adding new constraint test cases |
| `src/test/java/com/largomodo/floppyconvert/snes/SpecialCaseRegistryTest.java` | Unit tests for game-specific detection: Tales of Phantasia exact match, Dai Kaiju Monogatari 2 exact match, wrong maker/title combinations, case sensitivity | Verifying game detection logic, adding new special case tests |
| `src/test/java/com/largomodo/floppyconvert/snes/SnesInterleaverTest.java` | Property-based tests for GD3 HiROM/ExHiROM interleaver: global block mapping preserves all data (byte sum equality, all bytes present), block pair location correctness (output[i*32KB] from input[i*64KB + 32KB], output[n + i*32KB] from input[i*64KB]), edge cases (8Mbit single chunk, 16Mbit two chunks, 24Mbit three chunks), ExHiROM split-interleaving tests (40-64Mbit range), LoROM bypass test (input equals output) | Verifying global interleaving algorithm, testing cross-chunk block mapping, validating no data loss, verifying ExHiROM split-interleaving, verifying LoROM bypass |
| `src/test/java/com/largomodo/floppyconvert/snes/RomTypeTest.java` | Unit tests for RomType enum: memory map type functionality | Verifying RomType behavior |
| `src/test/java/com/largomodo/floppyconvert/snes/SnesRomTest.java` | Unit tests for SnesRom domain record: metadata validation, immutability | Verifying SnesRom record behavior |
| `src/test/java/com/largomodo/floppyconvert/snes/SnesRomReaderTest.java` | Property-based tests for SNES ROM reader with synthetic ROMs: header location probing, checksum validation, type detection, specific tests for 32Mbit HiROM with SRAM (SYNHI32T8) and 4Mbit LoROM (SYNLO4T0), no ROM file assumptions | Verifying ROM detection logic, adding new header detection scenarios, debugging type scoring algorithm |
| `src/test/java/com/largomodo/floppyconvert/snes/header/SwcSramEncoderTest.java` | Unit tests for SWC SRAM encoding: byte 2 encoding correctness (0x0C/0x08/0x04/0x00 for 256KB/64KB/16KB/0KB) | Verifying SWC SRAM encoding strategy |
| `src/test/java/com/largomodo/floppyconvert/snes/header/FigSramEncoderTest.java` | Unit tests for FIG SRAM encoding: byte 3 encoding correctness (0x0C/0x08/0x04/0x00 for 256KB/64KB/16KB/0KB) | Verifying FIG SRAM encoding strategy |
| `src/test/java/com/largomodo/floppyconvert/snes/header/UfoSramEncoderTest.java` | Unit tests for UFO SRAM encoding: byte 4 size code correctness, bytes 5-6 mapping control correctness | Verifying UFO SRAM encoding strategy |
| `src/test/java/com/largomodo/floppyconvert/snes/header/Gd3SramEncoderTest.java` | Unit tests for GD3 SRAM encoding: HiROM encoding (byte 7), LoROM encoding (byte 2), DSP flag handling | Verifying GD3 SRAM encoding strategy |
| `src/test/java/com/largomodo/floppyconvert/snes/header/SwcHeaderGeneratorTest.java` | Property-based tests for SWC header generation: partSize parameter validation, emulation mode encoding, multi-file flags, block count calculations, chunkFlag parameter (passed but ignored), behavior-focused test method names | Verifying SWC header correctness, adding test cases for edge cases |
| `src/test/java/com/largomodo/floppyconvert/snes/header/FigHeaderGeneratorTest.java` | Property-based tests for FIG header generation: partSize parameter validation, HiROM flags, multi-file flags, DSP encoding in emulation bytes, block count calculations, chunkFlag parameter (passed but ignored), behavior-focused test method names | Verifying FIG header correctness, adding test cases for edge cases |
| `src/test/java/com/largomodo/floppyconvert/snes/header/UfoHeaderGeneratorTest.java` | Property-based tests for UFO header generation: partSize parameter validation, dual-source size encoding (partSize for bytes 0-1, total size for byte 17), bank type encoding, chunkFlag parameter (used for byte 2), behavior-focused test method names | Verifying UFO header correctness, dual-source requirement, chunkFlag encoding, adding test cases for edge cases |
| `src/test/java/com/largomodo/floppyconvert/snes/header/Gd3HeaderGeneratorTest.java` | Property-based tests for GD3 header generation: partSize parameter ignored (uses total ROM size), first-part-only headers, memory map table selection, chunkFlag parameter (passed but ignored), behavior-focused test method names | Verifying GD3 header correctness, first-part-only behavior, adding test cases for edge cases |
| `src/test/java/com/largomodo/floppyconvert/snes/header/HeaderGeneratorFactoryTest.java` | Unit tests for HeaderGeneratorFactory: format-based generator selection, returns correct generator instances for each CopierFormat, behavior-focused test method names | Verifying factory logic, adding new format support |
| `src/test/java/com/largomodo/floppyconvert/snes/generators/SyntheticRomFactory.java` | Synthetic SNES ROM generator factory: 5-param overloads with custom titles (generateLoRom, generateHiRom, generateExHiRom), 4-param overloads with auto-generated unique titles (SYNLO{size}T{sram}{dsp} pattern), ExHiROM support (0x40FFB0 header, map mode 0x25, 48-64 Mbit range), generateTestSuite() creates pre-generated test ROMs, checksum+complement=0xFFFF validation | Adding new synthetic ROM variants, debugging ROM generation, understanding unique title patterns, generating test suite ROMs |
| `src/test/java/com/largomodo/floppyconvert/snes/generators/RomDataGenerator.java` | Property-based test data generator: creates synthetic SNES ROM byte arrays for jqwik, supports LoROM and HiROM data generation with proper headers | Adding new property-based test data sources, extending ROM data generation |
| `src/test/java/com/largomodo/floppyconvert/snes/generators/SyntheticRomFactoryTest.java` | Property-based tests for SyntheticRomFactory: custom title placement at correct header offsets, auto-generated title pattern validation, ExHiROM header at 0x40FFB0 detection, 64Mbit maximum size, invalid size error handling | Verifying synthetic ROM generation correctness, adding new generation test cases |
| `src/test/resources/logback-test.xml` | Test logging config: WARN threshold to suppress test noise | Debugging test log output |
| `README.md` | Architecture overview, format-specific naming examples (FIG/SWC .1/.2, UFO .1gm/.2gm, GD3 SF-Code), invisible knowledge rationale (native splitting, dual-source encoding, X-padding quirks, first-part-only headers), build instructions | Understanding system design, format-specific naming conventions, architectural rationale, running the tool |
| `PRELIMINARY-IMPLEMENTATION-PLAN.md` | Original design specification | Understanding historical context or design rationale |
| `implementation-plan-floppy-conversion.md` | Detailed implementation plan with milestones | Understanding implementation strategy or reviewing decisions |
| `implementation-plan-floppy-conversion-extension-ANNOTATED.md` | Multi-format extension plan with decision rationale | Understanding multi-format feature design or reviewing tradeoffs |
